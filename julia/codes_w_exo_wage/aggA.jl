aggA = (sum(a_by_occ .* (ones(n_O - 1) - τ_w[:, 1]) * gm[1] .* mass_O[1, :] + a_by_occ .* (ones(n_O - 1) - τ_w[:, 2]) * gm[2] .* mass_O[2, :]) + κ * gm[1] * mass_T[1] + κ * gm[2] * mass_T[2]) / (sum(gm[1] .* mass_O[1, :] + gm[2] .* mass_O[2, :]) + gm[1] * mass_T[1] + gm[2] * mass_T[2])
aggA = (sum(a_by_occ .* (ones(n_O - 1) - τ_w[:, 1]) * gm[1] .* mass_O[iHH, 1, :] + a_by_occ .* (ones(n_O - 1) - τ_w[:, 2]) * gm[2] .* mass_O[iHH, 2, :]) + κ * gm[1] * mass_T[iHH, 1] + κ * gm[2] * mass_T[iHH, 2]) / (sum(gm[1] .* mass_O[iHH, 1, :] + gm[2] .* mass_O[iHH, 2, :]) + gm[1] * mass_T[iHH, 1] + gm[2] * mass_T[iHH, 2])